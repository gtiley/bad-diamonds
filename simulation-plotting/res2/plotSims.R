library(ggplot2)
library(gridExtra)
library(grid)
library(gtable)

setwd("~/branch/badDiamond/res2/")

# Create user-defined function, which extracts legends from ggplots
extract_legend <- function(my_ggp) {
  step1 <- ggplot_gtable(ggplot_build(my_ggp))
  step2 <- which(sapply(step1$grobs, function(x) x$name) == "guide-box")
  step3 <- step1$grobs[[step2]]
  return(step3)
}


d1 <- read.table("snaqResults2/balancedRoot.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/ladderizedRoot.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/outgroupRoot.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)



d1 <- read.table("phylonetResults2/balancedRoot.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/ladderizedRoot.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/outgroupRoot.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)



####
#4 Rounds of error conditions
####



d1 <- read.table("snaqResults2/balancedRoot.0.rootchanged.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.10.rerooted.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/ladderizedRoot.0.rootchanged.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.10.rerooted.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/outgroupRoot.0.rootchanged.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.10.rerooted.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)



d1 <- read.table("phylonetResults2/balancedRoot.0.r.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.10.rerooted.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/ladderizedRoot.0.r.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.10.rerooted.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/outgroupRoot.0.r.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.10.rerooted.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)

####

d1 <- read.table("snaqResults2/balancedRoot.1.rootchanged.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.30.rerooted.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/ladderizedRoot.1.rootchanged.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.30.rerooted.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/outgroupRoot.1.rootchanged.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.30.rerooted.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)



d1 <- read.table("phylonetResults2/balancedRoot.1.r.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.30.rerooted.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/ladderizedRoot.1.r.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.30.rerooted.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/outgroupRoot.1.r.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.30.rerooted.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


####

d1 <- read.table("snaqResults2/balancedRoot.0.nni.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.10.nni.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/ladderizedRoot.0.nni.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.10.nni.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/outgroupRoot.0.nni.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.10.nni.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)



d1 <- read.table("phylonetResults2/balancedRoot.0.n.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.10.nni.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/ladderizedRoot.0.n.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.10.nni.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/outgroupRoot.0.n.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.10.nni.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)



####

d1 <- read.table("snaqResults2/balancedRoot.1.nni.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.30.nni.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/ladderizedRoot.1.nni.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.30.nni.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("snaqResults2/outgroupRoot.1.nni.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("snaq.30.nni.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)



d1 <- read.table("phylonetResults2/balancedRoot.1.n.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Balanced Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.30.nni.balancedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/ladderizedRoot.1.n.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Ladderized Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.30.nni.ladderizedRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)


d1 <- read.table("phylonetResults2/outgroupRoot.1.n.resultforPlotting.txt", sep = "\t",header=TRUE)
p1 <- ggplot(d1, aes(x=xPos,y=FoundOneEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("One Edge Detected",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5)) + ggtitle(expression(paste("Outgroup Root", sep="")))
p2 <- ggplot(d1, aes(x=xPos,y=CorrectNetwork/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Network is Correct",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_blank(), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))
p3 <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees),alpha=1.0)) + geom_point(size=3) +scale_shape_manual(values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"), limits=c(-0.1,1.1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(), axis.title = element_text(size = 8), legend.position = "none", axis.text.x = element_text(size=8), axis.text.y = element_text(size=8), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"),plot.title = element_text(size=10, hjust = 0.5))

plegend <- ggplot(d1, aes(x=xPos,y=HasHybridEdge/100,shape=factor(nTrees))) + geom_point(size=3) +scale_shape_manual(name="nTrees", labels=c("100","500","1000","5000"), values=c(1,2,3,4)) + scale_x_continuous(name=expression(paste("Diamond",sep="")), breaks=c(1,2,3,4,5,6,7,8,9),labels=c(expression(paste(d[1],sep="")),expression(paste(d[2],sep="")),expression(paste(d[3],sep="")),expression(paste(d[4],sep="")),expression(paste(d[5],sep="")),expression(paste(d[6],sep="")),expression(paste(d[7],sep="")),expression(paste(d[8],sep="")),expression(paste(d[9],sep="")))) + scale_y_continuous(name=expression(paste("Hybrid Edge Recovered",sep="")), breaks=c(0,0.25,0.5,0.75,1.0),labels=c("0","0.25","0.5","0.75","1.0"),limits=c(-0.1,1)) + theme(panel.background = element_rect(fill='white', colour='black'),panel.grid.minor.y = element_blank(),panel.grid.major.y = element_blank(),panel.grid.minor.x = element_blank(),axis.text = element_text(size = 8), axis.title = element_text(size = 10), legend.position = "bottom", axis.text.x = element_text(angle = 0), panel.grid.major.x = element_blank(), plot.margin=unit(c(0.05,0.05,0.05,0.05),"in"))
# Apply user-defined function to extract legend
shared_legend <- extract_legend(plegend)

g <- grid.arrange(arrangeGrob(p1, p2, p3, ncol = 1),shared_legend, nrow = 2, heights = c(11, 1))

ggsave("phylonet.30.nni.outgroupRoot.pdf",g,device="pdf",units="in",width=6.5,height=4.5)